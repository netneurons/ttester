<!DOCTYPE html>
<html>
<head>
	<title>OpenAI Chat Example</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		.chat-box {
			width: 400px;
			height: 500px;
			border: 1px solid black;
			overflow-y: scroll;
			padding: 10px;
			margin: 20px;
		}
		.message {
			margin: 10px;
			padding: 10px;
			border-radius: 10px;
			font-size: 18px;
			max-width: 80%;
		}
		.user-message {
			background-color: #F5F5F5;
			float: left;
		}
		.bot-message {
			background-color: #008CBA;
			color: white;
			float: right;
		}
		input[type="text"] {
			display: block;
			margin: 10px;
			font-size: 18px;
			padding: 5px;
			width: 80%;
		}
	</style>
</head>
<body>
	<div class="chat-box" id="chat-box"></div>
	<input type="text" id="user-input" placeholder="Type a message...">
	<script>
		const chatBox = document.getElementById('chat-box');
		const userInput = document.getElementById('user-input');

		const openaiApiKey = 'YOUR_API_KEY_HERE';

		let conversation = [];

		function sendMessage(message) {
			if (conversation.length === 0) {
				chatBox.innerHTML += '<div class="bot-message message">Initializing conversation...</div>';
				fetch('https://api.openai.com/v1/', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
						'Authorization': `Bearer ${openaiApiKey}`
					},
					body: JSON.stringify({
						engine: 'davinci',
						prompt: 'Hello, how can I assist you today?',
						temperature: 0.5,
						max_tokens: 60,
						stop: '\n'
					})
				}).then(response => response.json())
				.then(data => {
					conversation.push({
						sender: 'assistant',
						msg: 'Hello, how can I assist you today?'
					});
					conversation.push({
						sender: 'user',
						msg: message
					});
					conversation.push({
						sender: 'assistant',
						msg: data.choices[0].text.trim()
					});
					displayConversation();
				});
				return;
			}

			chatBox.innerHTML += `<div class="user-message message">${message}</div>`;
			userInput.value = '';

			fetch('https://api.openai.com/v1/', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
					'Authorization': `Bearer ${openaiApiKey}`
				},
				body: JSON.stringify({
					engine: 'davinci',
					prompt: conversation.map(item => `${item.sender}: ${item.msg}\n`).join('') + `user: ${message}\nassistant:`,
					temperature: 0.5,
					max_tokens: 60,
					stop: '\n'
				})
			}).then(response => response.json())
			.then(data => {
				conversation.push({
					sender: 'user',
					msg: message
				});
				conversation.push({
					sender: 'assistant',
					msg: data.choices[0].text.trim()
				});
				displayConversation();
			});
		}

		function displayConversation() {
			chatBox.innerHTML = '';
			conversation.forEach(item => {
				const className = item.sender === 'user' ? 'user-message' : 'bot-message';
				chatBox.innerHTML += `<div class="${className} message">${item.msg}</div>`;
			});
			chatBox.scrollTop = chatBox.scrollHeight;
		}

		userInput.addEventListener('keydown', event => {
			if (event.key === 'Enter' && userInput.value) {
				sendMessage(userInput.value);
			}
		});
	</script>
</body>
</html>